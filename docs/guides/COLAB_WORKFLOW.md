# Colab ì „ì²´ ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ

## ğŸ“Š ì „ì²´ í”„ë¡œì„¸ìŠ¤ íë¦„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Colab í™˜ê²½ ì„¤ì • (1íšŒ)                        â”‚
â”‚  - ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜                                              â”‚
â”‚  - í”„ë¡œì íŠ¸ íŒŒì¼ ì—…ë¡œë“œ/í´ë¡                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë°ì´í„° ì¤€ë¹„ ë° ê²€ì¦ (1íšŒ)                          â”‚
â”‚  - SDD ë°ì´í„°ì…‹ í™•ì¸                                            â”‚
â”‚  - í˜¸ëª¨ê·¸ë˜í”¼ í–‰ë ¬ í™•ì¸                                         â”‚
â”‚  - ë°ì´í„° ë³€í™˜ í™•ì¸                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë°ì´í„° ì „ì²˜ë¦¬ (1íšŒ)                                â”‚
â”‚  - ì¢Œí‘œ ë³€í™˜ (í”½ì…€ â†’ ë¯¸í„°)                                      â”‚
â”‚  - ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ìƒì„±                                          â”‚
â”‚  - ì´ìƒì¹˜ ì œê±° ë° ë³´ê°„                                          â”‚
â”‚  - Feature ì •ê·œí™”                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ì”¬ ê·¸ë˜í”„ ìƒì„± (1íšŒ ë˜ëŠ” í•„ìš”ì‹œ)                     â”‚
â”‚  - ë…¸ë“œ ìƒì„± (Agent, Map)                                       â”‚
â”‚  - ì—£ì§€ ìƒì„± (Spatial, Semantic)                                â”‚
â”‚  - PyTorch Geometric ë³€í™˜                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ëª¨ë¸ í•™ìŠµ (ë°˜ë³µ ê°€ëŠ¥)                               â”‚
â”‚  - ë°ì´í„° ë¡œë” ì„¤ì •                                              â”‚
â”‚  - ëª¨ë¸ ì´ˆê¸°í™”                                                   â”‚
â”‚  - í•™ìŠµ ì‹¤í–‰                                                     â”‚
â”‚  - ì²´í¬í¬ì¸íŠ¸ ì €ì¥                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ëª¨ë¸ í‰ê°€ (í•™ìŠµ í›„)                                 â”‚
â”‚  - ADE/FDE ê³„ì‚°                                                  â”‚
â”‚  - Miss Rate, Collision Rate                                    â”‚
â”‚  - ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¶„ì„                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ê²°ê³¼ ì‹œê°í™” (ì„ íƒì‚¬í•­)                              â”‚
â”‚  - ì–´í…ì…˜ ê°€ì¤‘ì¹˜ ì‹œê°í™”                                          â”‚
â”‚  - ê¶¤ì  ì˜ˆì¸¡ ì‹œê°í™”                                              â”‚
â”‚  - ì•ˆì „ ì§€í‘œ ì‹œê°í™”                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ë‹¨ê³„ë³„ ì‹¤í–‰ ê°€ì´ë“œ

### Phase 1: Colab í™˜ê²½ ì„¤ì • (5ë¶„)

#### Step 1-1: ìƒˆ Colab ë…¸íŠ¸ë¶ ìƒì„±

1. [Google Colab](https://colab.research.google.com/) ì ‘ì†
2. ìƒˆ ë…¸íŠ¸ë¶ ìƒì„±
3. ì´ë¦„: "Roundabout_AI_Training"

#### Step 1-2: í™˜ê²½ ì„¤ì • ì½”ë“œ ì‹¤í–‰

```python
# ì²« ë²ˆì§¸ ì…€: í™˜ê²½ ì„¤ì •
!pip install -q torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
!pip install -q torch-geometric torch-geometric-temporal
!pip install -q pandas numpy scipy scikit-learn matplotlib seaborn
!pip install -q opencv-python networkx tqdm pyyaml shapely
!pip install -q tensorboard

# GPU í™•ì¸
import torch
print(f"âœ“ GPU: {torch.cuda.is_available()}")
print(f"âœ“ GPU ì´ë¦„: {torch.cuda.get_device_name(0) if torch.cuda.is_available() else 'N/A'}")
```

#### Step 1-3: í”„ë¡œì íŠ¸ íŒŒì¼ ì—…ë¡œë“œ

**ë°©ë²• A: GitHubì—ì„œ í´ë¡  (ê¶Œì¥)**

```python
# ë‘ ë²ˆì§¸ ì…€: í”„ë¡œì íŠ¸ í´ë¡ 
!git clone https://github.com/your-repo/Roundabout_AI.git
%cd Roundabout_AI
```

**ë°©ë²• B: ì§ì ‘ ì—…ë¡œë“œ**

```python
# ë‘ ë²ˆì§¸ ì…€: íŒŒì¼ ì—…ë¡œë“œ
from google.colab import files
uploaded = files.upload()  # í”„ë¡œì íŠ¸ ZIP íŒŒì¼ ì—…ë¡œë“œ
!unzip project.zip -d Roundabout_AI
%cd Roundabout_AI
```

#### Step 1-4: ë°ì´í„°ì…‹ ì—…ë¡œë“œ

**ë°©ë²• A: Google Drive ë§ˆìš´íŠ¸ (ê¶Œì¥)**

```python
# ì„¸ ë²ˆì§¸ ì…€: Google Drive ë§ˆìš´íŠ¸
from google.colab import drive
drive.mount('/content/drive')

# ë°ì´í„° ë””ë ‰í† ë¦¬ ë§í¬
import os
os.symlink('/content/drive/MyDrive/Roundabout_AI/data', '/content/Roundabout_AI/data')
```

**ë°©ë²• B: ì§ì ‘ ì—…ë¡œë“œ**

```python
# ì„¸ ë²ˆì§¸ ì…€: ë°ì´í„° ì—…ë¡œë“œ
from google.colab import files
# data/sdd/converted/*.csv íŒŒì¼ë“¤ ì—…ë¡œë“œ
# data/sdd/homography/H.txt ì—…ë¡œë“œ
```

---

### Phase 2: ë°ì´í„° ì¤€ë¹„ ë° ê²€ì¦ (10ë¶„)

#### Step 2-1: ë°ì´í„° í™•ì¸

```python
# ë„¤ ë²ˆì§¸ ì…€: ë°ì´í„° í™•ì¸
import sys
sys.path.append('/content/Roundabout_AI')

from pathlib import Path
import pandas as pd

data_dir = Path('/content/Roundabout_AI/data/sdd/converted')
csv_files = list(data_dir.glob('*.csv'))

print(f"âœ“ ë³€í™˜ëœ ë°ì´í„° íŒŒì¼: {len(csv_files)}ê°œ")
for f in csv_files:
    df = pd.read_csv(f)
    print(f"  {f.name}: {len(df):,}í–‰, {df['track_id'].nunique()}ê°œ íŠ¸ë™")
```

#### Step 2-2: í˜¸ëª¨ê·¸ë˜í”¼ í™•ì¸

```python
# ë‹¤ì„¯ ë²ˆì§¸ ì…€: í˜¸ëª¨ê·¸ë˜í”¼ í™•ì¸
import numpy as np

h_path = Path('/content/Roundabout_AI/data/sdd/homography/H.txt')
if h_path.exists():
    H = np.loadtxt(h_path)
    print(f"âœ“ í˜¸ëª¨ê·¸ë˜í”¼ í–‰ë ¬:\n{H}")
    print(f"  í˜•íƒœ: {H.shape}")
else:
    print("âš ï¸  í˜¸ëª¨ê·¸ë˜í”¼ í–‰ë ¬ ì—†ìŒ - ìƒì„± í•„ìš”")
```

---

### Phase 3: ë°ì´í„° ì „ì²˜ë¦¬ (30ë¶„)

#### Step 3-1: ë°ì´í„° ë¡œë“œ ë° í†µí•©

```python
# ì—¬ì„¯ ë²ˆì§¸ ì…€: ë°ì´í„° í†µí•©
import pandas as pd
from pathlib import Path

data_dir = Path('/content/Roundabout_AI/data/sdd/converted')
all_data = []

for csv_file in sorted(data_dir.glob('*.csv')):
    df = pd.read_csv(csv_file)
    df['video_id'] = csv_file.stem.replace('_converted', '')
    all_data.append(df)
    print(f"âœ“ {csv_file.name}: {len(df):,}í–‰")

combined_df = pd.concat(all_data, ignore_index=True)
print(f"\nâœ“ í†µí•© ë°ì´í„°: {len(combined_df):,}í–‰")
print(f"  íŠ¸ë™ ìˆ˜: {combined_df['track_id'].nunique()}")
print(f"  ì—ì´ì „íŠ¸ íƒ€ì…: {sorted(combined_df['agent_type'].unique())}")
```

#### Step 3-2: ì „ì²˜ë¦¬ ì‹¤í–‰

```python
# ì¼ê³± ë²ˆì§¸ ì…€: ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
import sys
sys.path.append('/content/Roundabout_AI')

from src.data_processing.preprocessor import (
    CoordinateTransformer,
    SlidingWindowGenerator,
    OutlierInterpolator,
    FeatureNormalizer
)

# ì „ì²˜ë¦¬ ì„¤ì •
obs_window = 30  # 3ì´ˆ (10Hz)
pred_window = 50  # 5ì´ˆ (10Hz)

# 1. ì¢Œí‘œ ë³€í™˜ (ì´ë¯¸ ì™„ë£Œë¨ - í™•ì¸ë§Œ)
print("1. ì¢Œí‘œ ë³€í™˜ í™•ì¸...")
print(f"   X ë²”ìœ„: [{combined_df['x'].min():.2f}, {combined_df['x'].max():.2f}]")
print(f"   Y ë²”ìœ„: [{combined_df['y'].min():.2f}, {combined_df['y'].max():.2f}]")

# 2. ì´ìƒì¹˜ ì œê±° ë° ë³´ê°„
print("\n2. ì´ìƒì¹˜ ì œê±° ë° ë³´ê°„...")
interpolator = OutlierInterpolator()
# ê° íŠ¸ë™ë³„ë¡œ ì²˜ë¦¬
# (ì‹¤ì œ êµ¬í˜„ í•„ìš”)

# 3. ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ìƒì„±
print("\n3. ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ìƒì„±...")
window_generator = SlidingWindowGenerator(
    obs_window=obs_window,
    pred_window=pred_window
)

windows = []
for track_id in combined_df['track_id'].unique()[:100]:  # ìƒ˜í”Œë§
    track_data = combined_df[combined_df['track_id'] == track_id].sort_values('frame_id')
    track_windows = window_generator.create_windows(track_data)
    windows.extend(track_windows)

print(f"   âœ“ ìƒì„±ëœ ìœˆë„ìš°: {len(windows)}ê°œ")

# 4. Feature ì •ê·œí™”
print("\n4. Feature ì •ê·œí™”...")
normalizer = FeatureNormalizer()
# ì •ê·œí™” ì‹¤í–‰
# (ì‹¤ì œ êµ¬í˜„ í•„ìš”)

print("\nâœ“ ì „ì²˜ë¦¬ ì™„ë£Œ!")
```

#### Step 3-3: ì „ì²˜ë¦¬ ê²°ê³¼ ì €ì¥

```python
# ì—¬ëŸ ë²ˆì§¸ ì…€: ì „ì²˜ë¦¬ ê²°ê³¼ ì €ì¥
import pickle
from pathlib import Path

output_dir = Path('/content/Roundabout_AI/data/processed')
output_dir.mkdir(parents=True, exist_ok=True)

# ìœˆë„ìš° ë°ì´í„° ì €ì¥
with open(output_dir / 'sdd_windows.pkl', 'wb') as f:
    pickle.dump(windows, f)

print(f"âœ“ ì „ì²˜ë¦¬ ê²°ê³¼ ì €ì¥: {output_dir / 'sdd_windows.pkl'}")
print(f"  ìœˆë„ìš° ìˆ˜: {len(windows)}ê°œ")
```

---

### Phase 4: ì”¬ ê·¸ë˜í”„ ìƒì„± (ì„ íƒì‚¬í•­, 20ë¶„)

#### Step 4-1: ì”¬ ê·¸ë˜í”„ ë¹Œë” ì´ˆê¸°í™”

```python
# ì•„í™‰ ë²ˆì§¸ ì…€: ì”¬ ê·¸ë˜í”„ ìƒì„± (ì„ íƒì‚¬í•­)
import sys
sys.path.append('/content/Roundabout_AI')

from src.scene_graph.scene_graph_builder import SceneGraphBuilder

builder = SceneGraphBuilder(
    spatial_threshold=20.0,  # 20m
    use_semantic_edges=True
)

print("âœ“ ì”¬ ê·¸ë˜í”„ ë¹Œë” ì´ˆê¸°í™” ì™„ë£Œ")
```

#### Step 4-2: ìƒ˜í”Œ í”„ë ˆì„ìœ¼ë¡œ í…ŒìŠ¤íŠ¸

```python
# ì—´ ë²ˆì§¸ ì…€: ìƒ˜í”Œ ì”¬ ê·¸ë˜í”„ ìƒì„±
import pandas as pd

# ìƒ˜í”Œ í”„ë ˆì„ ì„ íƒ
sample_frame = combined_df[combined_df['frame_id'] == combined_df['frame_id'].min() + 100]

# ì”¬ ê·¸ë˜í”„ ìƒì„±
graph = builder.build_from_frame(sample_frame)
pyg_data = builder.to_pytorch_geometric()

print(f"âœ“ ì”¬ ê·¸ë˜í”„ ìƒì„± ì™„ë£Œ")
print(f"  ë…¸ë“œ ìˆ˜: {pyg_data.x.size(0)}")
print(f"  ì—£ì§€ ìˆ˜: {pyg_data.edge_index.size(1)}")
```

---

### Phase 5: ëª¨ë¸ í•™ìŠµ (1-4ì‹œê°„)

#### Step 5-1: í•™ìŠµ ì„¤ì •

```python
# ì—´í•œ ë²ˆì§¸ ì…€: í•™ìŠµ ì„¤ì •
import yaml
from pathlib import Path

config = {
    'model': {
        'name': 'a3tgcn',
        'node_features': 9,
        'hidden_channels': 64,
        'num_layers': 2,
        'periods': 30,
        'pred_steps': 50
    },
    'data': {
        'data_dir': '/content/Roundabout_AI/data/processed',
        'batch_size': 32,
        'num_workers': 2,
        'train_ratio': 0.7,
        'val_ratio': 0.15,
        'test_ratio': 0.15
    },
    'training': {
        'optimizer': 'adam',
        'learning_rate': 0.001,
        'weight_decay': 1e-5,
        'scheduler': 'reduce_on_plateau',
        'loss': 'mse',
        'num_epochs': 50,
        'early_stopping': {
            'patience': 10,
            'min_delta': 0.001
        }
    },
    'logging': {
        'log_dir': '/content/Roundabout_AI/runs',
        'save_dir': '/content/Roundabout_AI/checkpoints'
    }
}

# ì„¤ì • íŒŒì¼ ì €ì¥
config_path = Path('/content/Roundabout_AI/configs/colab_config.yaml')
config_path.parent.mkdir(parents=True, exist_ok=True)
with open(config_path, 'w') as f:
    yaml.dump(config, f)

print("âœ“ í•™ìŠµ ì„¤ì • ì €ì¥ ì™„ë£Œ")
```

#### Step 5-2: ë¹ ë¥¸ í•™ìŠµ ì‹¤í–‰

```python
# ì—´ë‘ ë²ˆì§¸ ì…€: ë¹ ë¥¸ í•™ìŠµ ì‹¤í–‰
import sys
sys.path.append('/content/Roundabout_AI')

from src.training.train import main as train_main
import argparse

# ë¹ ë¥¸ í•™ìŠµ ì„¤ì •
args = argparse.Namespace(
    config='configs/colab_config.yaml',
    data_dir='data/processed',
    resume=None
)

print("=" * 80)
print("í•™ìŠµ ì‹œì‘")
print("=" * 80)

# í•™ìŠµ ì‹¤í–‰
train_main()
```

#### Step 5-3: TensorBoard ëª¨ë‹ˆí„°ë§

```python
# ì—´ì„¸ ë²ˆì§¸ ì…€: TensorBoard ì‹¤í–‰ (ë³„ë„ íƒ­ì—ì„œ)
# ì´ ì…€ì€ ì‹¤í–‰ í›„ ë³„ë„ íƒ­ì—ì„œ TensorBoard í™•ì¸
%load_ext tensorboard
%tensorboard --logdir /content/Roundabout_AI/runs --port 6006
```

---

### Phase 6: ëª¨ë¸ í‰ê°€ (30ë¶„)

#### Step 6-1: ëª¨ë¸ ë¡œë“œ ë° í‰ê°€

```python
# ì—´ë„¤ ë²ˆì§¸ ì…€: ëª¨ë¸ í‰ê°€
import sys
sys.path.append('/content/Roundabout_AI')
import torch
from src.evaluation.evaluator import ModelEvaluator
from src.models.a3tgcn_model import create_a3tgcn_model

# ëª¨ë¸ ë¡œë“œ
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = create_a3tgcn_model(
    node_features=9,
    hidden_channels=64,
    pred_steps=50
)

checkpoint_path = Path('/content/Roundabout_AI/checkpoints/best_model.pth')
if checkpoint_path.exists():
    checkpoint = torch.load(checkpoint_path, map_location=device)
    model.load_state_dict(checkpoint['model_state_dict'])
    print("âœ“ ëª¨ë¸ ë¡œë“œ ì™„ë£Œ")
else:
    print("âš ï¸  ì²´í¬í¬ì¸íŠ¸ ì—†ìŒ - í•™ìŠµ ë¨¼ì € ì‹¤í–‰ í•„ìš”")

# í‰ê°€ ì‹¤í–‰
# (ë°ì´í„° ë¡œë” í•„ìš”)
```

#### Step 6-2: í‰ê°€ ì§€í‘œ ê³„ì‚°

```python
# ì—´ë‹¤ì„¯ ë²ˆì§¸ ì…€: í‰ê°€ ì§€í‘œ ê³„ì‚°
import sys
sys.path.append('/content/Roundabout_AI')
from src.evaluation.metrics import TrajectoryEvaluator
import numpy as np

evaluator = TrajectoryEvaluator()

# ë”ë¯¸ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸ (ì‹¤ì œë¡œëŠ” ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼ ì‚¬ìš©)
predicted = np.random.randn(10, 50, 2) * 0.5
ground_truth = predicted + np.random.randn(10, 50, 2) * 0.1

metrics = evaluator.evaluate(predicted, ground_truth)

print("=" * 60)
print("í‰ê°€ ì§€í‘œ")
print("=" * 60)
for key, value in metrics.items():
    if 'Rate' in key:
        print(f"{key:25s}: {value:.4f} ({value*100:.2f}%)")
    else:
        print(f"{key:25s}: {value:.4f} m")
```

---

### Phase 7: ê²°ê³¼ ì‹œê°í™” (ì„ íƒì‚¬í•­, 20ë¶„)

#### Step 7-1: ì–´í…ì…˜ ê°€ì¤‘ì¹˜ ì‹œê°í™”

```python
# ì—´ì—¬ì„¯ ë²ˆì§¸ ì…€: ì–´í…ì…˜ ì‹œê°í™”
import sys
sys.path.append('/content/Roundabout_AI')
from src.visualization.attention_visualizer import AttentionVisualizer
import numpy as np

visualizer = AttentionVisualizer()

# ìƒ˜í”Œ ë°ì´í„°
num_nodes = 10
positions = np.random.randn(num_nodes, 2) * 10
attention_matrix = visualizer.compute_distance_based_attention(positions)

# ì‹œê°í™”
visualizer.visualize_attention_heatmap(
    attention_matrix,
    output_path=Path('/content/Roundabout_AI/results/attention_heatmap.png')
)

print("âœ“ ì–´í…ì…˜ íˆíŠ¸ë§µ ì €ì¥ ì™„ë£Œ")
```

#### Step 7-2: ê²°ê³¼ ë‹¤ìš´ë¡œë“œ

```python
# ì—´ì¼ê³± ë²ˆì§¸ ì…€: ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
from google.colab import files
from pathlib import Path

# ì²´í¬í¬ì¸íŠ¸ ë‹¤ìš´ë¡œë“œ
files.download('/content/Roundabout_AI/checkpoints/best_model.pth')

# ê²°ê³¼ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
for img_file in Path('/content/Roundabout_AI/results').glob('*.png'):
    files.download(str(img_file))

print("âœ“ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ")
```

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í™˜ê²½ ì„¤ì •

- [ ] Colab ë…¸íŠ¸ë¶ ìƒì„±
- [ ] ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ì™„ë£Œ
- [ ] í”„ë¡œì íŠ¸ íŒŒì¼ ì—…ë¡œë“œ/í´ë¡ 
- [ ] ë°ì´í„°ì…‹ ì—…ë¡œë“œ

### ë°ì´í„° ì¤€ë¹„

- [ ] ë°ì´í„° íŒŒì¼ í™•ì¸
- [ ] í˜¸ëª¨ê·¸ë˜í”¼ í–‰ë ¬ í™•ì¸
- [ ] ë°ì´í„° í†µí•© ì™„ë£Œ

### ì „ì²˜ë¦¬

- [ ] ì¢Œí‘œ ë³€í™˜ í™•ì¸
- [ ] ì´ìƒì¹˜ ì œê±° ì™„ë£Œ
- [ ] ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ìƒì„±
- [ ] Feature ì •ê·œí™” ì™„ë£Œ

### í•™ìŠµ

- [ ] í•™ìŠµ ì„¤ì • ì™„ë£Œ
- [ ] ë°ì´í„° ë¡œë” í…ŒìŠ¤íŠ¸
- [ ] ëª¨ë¸ ì´ˆê¸°í™” ì™„ë£Œ
- [ ] í•™ìŠµ ì‹œì‘
- [ ] TensorBoard ëª¨ë‹ˆí„°ë§

### í‰ê°€

- [ ] ëª¨ë¸ ë¡œë“œ ì™„ë£Œ
- [ ] í‰ê°€ ì§€í‘œ ê³„ì‚°
- [ ] ê²°ê³¼ ì €ì¥

---

## âš¡ ë¹ ë¥¸ ì‹¤í–‰ (ìµœì†Œ ì„¤ì •)

ì „ì²´ ê³¼ì •ì„ í•œ ë²ˆì— ì‹¤í–‰í•˜ë ¤ë©´:

```python
# ëª¨ë“  ë‹¨ê³„ë¥¼ í¬í•¨í•œ í†µí•© ìŠ¤í¬ë¦½íŠ¸
!python /content/Roundabout_AI/scripts/colab_full_pipeline.py \
    --data_dir /content/Roundabout_AI/data/sdd/converted \
    --output_dir /content/Roundabout_AI/data/processed \
    --batch_size 32 \
    --epochs 30 \
    --sample_ratio 0.3 \
    --use_amp
```

---

## ğŸ”„ ë³‘ë ¬ ì‹¤í–‰ ì „ëµ

### Colab (GPU í•™ìŠµ)

- Phase 5: ëª¨ë¸ í•™ìŠµ
- Phase 6: ëª¨ë¸ í‰ê°€
- Phase 7: ê²°ê³¼ ì‹œê°í™”

### ë¡œì»¬ (ë°ì´í„° ì¤€ë¹„)

- Phase 2: ë°ì´í„° ì¤€ë¹„ ë° ê²€ì¦
- Phase 3: ë°ì´í„° ì „ì²˜ë¦¬
- Phase 4: ì”¬ ê·¸ë˜í”„ ìƒì„±

ì´ë ‡ê²Œ ë¶„ë¦¬í•˜ë©´ íš¨ìœ¨ì ì…ë‹ˆë‹¤!
