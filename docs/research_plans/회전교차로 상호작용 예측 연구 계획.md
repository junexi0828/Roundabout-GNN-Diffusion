# **INTERACTION Dataset 기반 회전교차로 씬 그래프 및 GNN 상호작용 예측 연구: 타당성 검증 및 실행 전략 보고서**

## **1\. 서론: 자율주행 기술의 난제와 회전교차로의 특수성**

### **1.1 연구 배경 및 동기**

자율주행 기술의 발전 단계에서 가장 큰 걸림돌 중 하나는 '상호작용(Interaction)'이 빈번하게 발생하는 비정형 도로 환경에서의 의사결정 문제입니다. 고속도로와 같이 차선 유지(Lane Keeping)와 차간 거리 조절(Adaptive Cruise Control)이 주를 이루는 환경과 달리, 도심지 회전교차로(Roundabout)는 명시적인 신호등 없이 운전자 간의 암묵적인 협상(Negotiation)과 양보(Yielding)에 의해 교통 흐름이 제어되는 고도로 복잡한 환경입니다. 이러한 환경에서 자율주행 차량(Ego-Vehicle)이 안전하고 효율적으로 주행하기 위해서는 주변 차량의 물리적 궤적(Trajectory)만을 예측하는 것을 넘어, 그들의 잠재적 의도(Intention)와 상호작용의 역학 관계를 이해해야 합니다.1

기존의 물리 기반 모델(Physics-based Model)이나 규칙 기반(Rule-based) 접근 방식은 복잡한 다중 에이전트 간의 상호작용을 수식화하는 데 한계를 보입니다. 예를 들어, Intelligent Driver Model (IDM)과 같은 차량 추종 모델은 선행 차량과의 관계만을 고려할 뿐, 회전교차로 진입 시 발생하는 측면 차량과의 눈치 싸움이나 간격 수락(Gap Acceptance) 거동을 정밀하게 모사하지 못합니다. 이에 따라 최근 연구 동향은 씬 그래프(Scene Graph)를 통해 도로 구조와 에이전트 간의 관계를 위상학적으로 모델링하고, 그래프 신경망(Graph Neural Network, GNN)을 활용하여 이러한 관계 정보를 학습 기반으로 예측하는 방향으로 선회하고 있습니다.3

본 보고서는 INTERACTION Dataset을 활용하여 회전교차로 환경에서의 차량 상호작용을 예측하기 위한 딥러닝 모델, 특히 Social-STGCNN과 Trajectron++의 적용 가능성을 심층 분석합니다. 또한, 딥러닝 모델의 본질적인 불확실성과 학습 실패 가능성에 대비하여, 기하학적(Geometric) 및 운동학적(Kinematic) 분석에 기반한 대체 안전 지표(Surrogate Safety Measures, SSM) 시스템 구축을 'Plan B'로 제시하여 연구의 완결성을 보장하고자 합니다.

### **1.2 연구의 목적 및 범위**

본 연구의 핵심 목적은 **"실행 가능한(Actionable)"** 오픈소스 솔루션의 검증입니다. 단순히 최신 논문을 리뷰하는 것을 넘어, 실제 코드 레벨에서의 가용성, 데이터셋과의 호환성, 그리고 회전교차로라는 특수 환경에서의 적합성을 평가합니다.

1. **데이터셋 심층 분석:** INTERACTION Dataset이 회전교차로 연구에 적합한지, 데이터 포맷(CSV, OSM/Lanelet2)이 GNN 모델 학습에 어떻게 적용될 수 있는지 분석합니다.5  
2. **GNN 모델 검증 (Plan A):** 씬 그래프 기반의 대표적 오픈소스인 Social-STGCNN과 Trajectron++의 아키텍처를 분석하고, 특히 회전교차로의 기하학적 제약 조건을 반영할 수 있는지 평가합니다. 여기서 trajdata와 같은 통합 데이터 로더의 활용성을 핵심 성공 요인으로 다룹니다.7  
3. **대체 전략 수립 (Plan B):** 연구 실패(학습 부진, 일반화 실패 등)에 대비하여, Time-to-Collision (TTC), Post-Encroachment Time (PET) 등의 안전 지표를 Python 기반으로 직접 산출하는 알고리즘을 설계합니다. 이는 단순한 대안을 넘어, Plan A 모델의 예측 결과를 검증(Validation)하는 'Oracle' 역할로도 확장 가능합니다.9

## ---

**2\. INTERACTION Dataset 심층 분석: 회전교차로 시나리오의 적합성**

### **2.1 데이터셋의 구성 및 차별성**

INTERACTION Dataset은 기존의 자율주행 데이터셋(KITTI, Waymo, Argoverse 등)과 뚜렷하게 구별되는 특징을 가지고 있습니다. 기존 데이터셋들이 주로 자율주행 차량(Ego-vehicle)에 장착된 센서(LiDAR, Camera) 관점의 데이터를 제공하여 인지(Perception) 문제 해결에 집중했다면, INTERACTION Dataset은 드론이나 고정형 카메라를 통해 수집된 '조감도(Bird's-eye view)' 시점의 데이터를 제공합니다.1 이는 사각지대(Occlusion) 없이 모든 에이전트의 궤적을 끊김 없이 추적할 수 있게 하여, 상호작용 연구에 있어 결정적인 이점을 제공합니다.

특히 본 연구의 대상인 **회전교차로(Roundabout)** 시나리오와 관련하여, 이 데이터셋은 미국, 중국, 독일 등 다양한 국가의 회전교차로 데이터를 포함하고 있습니다. 이는 국가별 운전 문화(Driving Culture)와 교통 법규의 차이를 학습할 수 있는 다양성을 제공합니다.1 데이터셋에는 양보 표지판(Yield sign)이 있는 회전교차로, 정지 표지판이 있는 교차로 등 다양한 통제 환경이 포함되어 있어, 불확실한 통행 우선권(Inexplicit right-of-way) 상황에서의 협상 행동을 모델링하기에 최적입니다.11

### **2.2 데이터 포맷 및 좌표계 분석**

연구의 실행 가능성을 확보하기 위해서는 데이터의 물리적 구조를 정확히 파악해야 합니다. INTERACTION Dataset은 크게 궤적 파일과 지도 파일로 구성됩니다.

* **궤적 데이터 (vehicle\_tracks\_xxx.csv):** 각 행(Row)은 특정 시점($t$)에서의 특정 에이전트($i$)의 상태를 나타냅니다. 주요 컬럼으로는 track\_id, frame\_id, timestamp\_ms, agent\_type, x, y, vx, vy, psi\_rad(헤딩 각도), length, width 등이 포함됩니다.5 여기서 주목해야 할 점은 좌표계입니다. 제공되는 $(x, y)$ 좌표는 절대 위도/경도가 아닌, 해당 맵의 원점을 기준으로 하는 \*\*상대 좌표(Relative Coordinate)\*\*입니다.5 따라서 연구 수행 시 별도의 좌표 변환 없이 제공된 좌표계를 그대로 씬 그래프의 노드 속성(Node Feature)으로 사용해야 합니다.  
* **HD 지도 데이터 (xxx.osm):** 도로 네트워크 정보는 Lanelet2 포맷의 OSM 파일로 제공됩니다.1 이 파일에는 차선의 연결성(Connectivity), 주행 가능 방향, 제한 속도, 교통 규칙 등의 의미론적(Semantic) 정보가 포함되어 있습니다. 회전교차로에서 차량은 도로의 곡률을 따라 주행해야 하므로, 이러한 맵 정보는 예측 모델의 물리적 타당성(Physical Feasibility)을 보장하는 데 핵심적인 역할을 합니다. Plan A의 후보 모델인 Trajectron++는 이러한 맵 정보를 인코딩하여 활용할 수 있는 기능을 내장하고 있습니다.12

### **2.3 데이터의 복잡성 및 임계 상황 (Criticality)**

단순한 주행 데이터뿐만 아니라, 근접 사고(Near-collision) 상황이나 경미한 사고 상황까지 포함되어 있다는 점은 이 데이터셋의 가치를 높여줍니다.1 일반적인 주행 데이터만으로는 학습하기 어려운 '위험 회피 기동'이나 '급제동'과 같은 엣지 케이스(Edge Case)를 포함하고 있어, GNN 모델이 단순히 평균적인 주행 패턴(Mean behavior)으로 수렴하는 것을 방지하고, 안전에 민감한(Safety-critical) 예측을 수행할 수 있게 합니다.

| 특성 | 세부 내용 | 연구 함의 |
| :---- | :---- | :---- |
| **시나리오 다양성** | 회전교차로, 비신호 교차로, 합류 구간 등 | 다양한 상호작용 패턴 학습 가능 |
| **관측 시점** | 드론/고정 카메라 (조감도) | 완전한 궤적 정보 확보 (Occlusion 없음) |
| **좌표계** | 상대 좌표 (Local Relative) | 맵-궤적 정합성 유지 용이 |
| **맵 포맷** | Lanelet2 (OSM) | 도로 네트워크 및 의미론적 정보 활용 가능 |
| **임계 상황** | Near-miss, Minor accident 포함 | 안전 관련 Plan B 지표 검증에 활용 |

## ---

**3\. Plan A: GNN 기반 상호작용 예측 모델 검증 및 전략**

### **3.1 씬 그래프(Scene Graph)와 상호작용 모델링의 이론적 배경**

씬 그래프는 복잡한 장면을 객체(Node)와 객체 간의 관계(Edge)로 추상화하여 표현하는 자료구조입니다. 교통 환경에서 노드($V$)는 차량, 보행자 등의 에이전트를 나타내며, 엣지($E$)는 이들 간의 사회적(Social) 또는 공간적(Spatial) 상호작용을 나타냅니다.

$$G\_t \= (V\_t, E\_t)$$  
여기서 $V\_t \= {v\_1^t, v\_2^t,..., v\_n^t}$는 시간 $t$에서의 에이전트 집합이며, 각 노드 $v\_i$는 위치, 속도, 가속도 등의 특징 벡터(Feature Vector)를 가집니다. 인접 행렬(Adjacency Matrix) $A\_t$ 또는 엣지 속성은 에이전트 간의 거리나 상호작용의 강도를 나타냅니다. GNN, 특히 ST-GCN(Spatio-Temporal Graph Convolutional Network)은 이러한 그래프 구조 위에서 공간적 합성곱(Spatial Convolution)과 시간적 합성곱(Temporal Convolution)을 수행하여, 주변 에이전트의 상태가 대상 에이전트의 미래 경로에 미치는 영향을 학습합니다.13

### **3.2 모델 1: Social-STGCNN (검증 및 한계점)**

아키텍처 개요:  
Social-STGCNN은 보행자 궤적 예측을 위해 제안된 모델로, 사람 간의 상호작용을 그래프로 모델링합니다.3 기존의 RNN/LSTM 기반 모델들이 순차적인 데이터 처리에 의존하여 연산 속도가 느린 단점을 극복하기 위해, 전체 시계열 데이터를 한 번에 처리하는 CNN 기반 구조(Time-Extrapolator CNN, TXP-CNN)를 채택했습니다.  
**장점:**

1. **연산 효율성:** 파라미터 수가 적고(약 7.6K), 추론 속도가 매우 빠릅니다(0.002s/frame).3 실시간성이 중요한 자율주행 시스템에 유리합니다.  
2. **데이터 효율성:** 적은 양의 데이터로도 기존 모델 대비 우수한 성능(ADE/FDE 개선)을 보여줍니다.3

**회전교차로 적용 시 치명적 한계 (Risk Analysis):**

1. **운동학적 제약 부재:** 이 모델은 본래 보행자(Pedestrian)를 위해 설계되었습니다. 보행자는 제자리에서 회전하거나 급격하게 방향을 바꿀 수 있는 홀로노믹(Holonomic) 특성을 가지지만, 차량은 조향 장치의 물리적 한계로 인해 비홀로노믹(Non-holonomic) 제약을 받습니다 (Ackermann Steering Geometry). Social-STGCNN을 차량에 그대로 적용할 경우, 차량이 옆으로 미끄러지거나 물리적으로 불가능한 궤적을 예측할 위험이 큽니다.14  
2. **지도 정보(Map Constraints) 미반영:** Social-STGCNN은 에이전트 간의 상대적 위치만을 고려할 뿐, 도로의 구조(차선, 도로 경계)를 입력으로 받지 않습니다.3 회전교차로에서는 차량이 반드시 곡선 차로를 따라 주행해야 하는데, 맵 정보가 없으면 모델은 차량이 중앙 교통섬을 가로지르는 궤적을 생성할 수 있습니다.

**결론:** Social-STGCNN은 가벼운 **베이스라인(Baseline)** 모델로서는 가치가 있으나, 정밀한 회전교차로 주행 예측을 위한 최종 솔루션으로는 부적합할 가능성이 높습니다.

### **3.3 모델 2: Trajectron++ (최적의 Plan A 솔루션)**

아키텍처 개요:  
Trajectron++는 다중 에이전트 상호작용 예측을 위한 생성형 모델(CVAE 기반)로, 특히 이종 데이터(Heterogeneous Data) 처리에 특화되어 있습니다.4  
**회전교차로 연구를 위한 핵심 강점:**

1. **HD 지도 인코딩 (Map Encoding):** Trajectron++는 Lanelet2 포맷의 맵 데이터를 입력으로 받아, 에이전트 주변의 도로 구조를 CNN으로 인코딩하여 잠재 벡터(Latent Vector)에 반영합니다.12 이는 차량이 회전교차로의 차선을 준수하도록 유도하는 데 결정적인 역할을 합니다.  
2. **동역학 통합 (Dynamics Integration):** 차량을 단순한 점(Point)이 아닌, 동역학 모델(Dynamically-extended Unicycle Model)을 따르는 객체로 모델링합니다. 네트워크는 위치 좌표를 직접 예측하는 대신, 제어 입력(가속도, 조향각 등)을 예측하고 이를 시스템 동역학 식에 적분하여 궤적을 산출합니다.14 이는 물리적으로 실현 가능한(Dynamically feasible) 궤적을 보장합니다.  
3. **이종 에이전트 처리:** 회전교차로에는 차량뿐만 아니라 트럭, 자전거 등 다양한 에이전트가 혼재합니다. Trajectron++는 에이전트 유형별로 서로 다른 의미론적 클래스를 부여하고 이를 그래프 노드 속성에 반영하여 유형별 거동 차이를 학습합니다.12

실행 전략 (Implementation Roadmap):  
Trajectron++의 가장 큰 진입 장벽은 복잡한 데이터 전처리 과정입니다. 그러나 최근 공개된 trajdata 라이브러리 7는 INTERACTION Dataset을 기본적으로 지원(Native Support)합니다.

* 1단계: 데이터 로딩 파이프라인 구축  
  trajdata를 활용하여 INTERACTION Dataset의 원본 파일(CSV, OSM)을 Trajectron++가 학습 가능한 텐서 형태로 변환합니다. UnifiedDataset 클래스를 사용하면 interaction\_multi 스플릿을 손쉽게 로드할 수 있습니다.7  
  Python  
  \# trajdata 활용 예시 (개념적 코드)  
  from trajdata import UnifiedDataset  
  dataset \= UnifiedDataset(  
      desired\_data=\["interaction\_multi"\],  
      data\_dirs={"interaction\_multi": "./dataset/interaction\_dataset"}  
  )

  이 과정은 데이터의 샘플링 속도(10Hz)를 맞추고, 결측치를 보간하며, 맵 데이터를 벡터화하는 복잡한 과정을 추상화해줍니다.  
* 2단계: 모델 구성 및 학습  
  conf/config.yaml 파일에서 map\_encoding: true와 dynamics\_integration: true 옵션을 활성화해야 합니다. 이는 모델이 회전교차로의 기하학적 구조와 차량의 물리적 특성을 학습에 반영하도록 강제합니다.  
* **3단계: 검증 지표 설정**  
  * **ADE (Average Displacement Error):** 전체 예측 경로의 평균 오차.  
  * **FDE (Final Displacement Error):** 예측 종료 시점의 위치 오차.  
  * **Collision Rate:** 예측된 궤적 간의 충돌 발생 비율 (Plan B와 연계).  
  * **Lane Violation Rate:** 예측 궤적이 도로 경계를 침범하는 비율 (맵 인코딩 효과 검증).

## ---

**4\. Plan B: 기하학적/운동학적 분석 기반 대체 전략 및 안전 검증 시스템**

### **4.1 Plan B의 필요성과 철학**

Plan A인 딥러닝 모델은 데이터 편향, 과적합(Overfitting), 또는 복잡한 시나리오에서의 추론 실패(Hallucination) 가능성을 내포하고 있습니다. 연구의 실패를 방지하고, 나아가 개발된 AI 모델의 신뢰성을 검증하기 위해서는 **결정론적(Deterministic)이고 설명 가능한(Explainable)** 분석 도구가 필수적입니다. Plan B는 단순한 대안이 아니라, 자율주행 시스템의 안전을 보장하는 \*\*'Safety Layer'\*\*로서 기능합니다.

### **4.2 충돌 분석을 위한 기하학적 모델링 (Geometric Modeling)**

충돌 지점(Conflict Point) 식별:  
회전교차로의 상호작용은 주로 합류(Merging), 분류(Diverging), 교차(Crossing) 지점에서 발생합니다. 이를 파이썬 환경에서 분석하기 위해 shapely 라이브러리를 활용합니다.16

* **궤적의 객체화:** 각 차량의 궤적을 LineString 객체로 변환합니다. 차량의 크기(width)를 고려하여 buffer() 함수를 적용하면 궤적은 띠 모양의 Polygon이 됩니다.  
* **교차 검사:** 두 차량의 Polygon 간 intersection() 연산을 통해 기하학적 충돌 후보 영역을 추출합니다. 이 영역이 존재한다고 해서 반드시 충돌하는 것은 아니며(시간차가 있을 수 있음), 이는 후술할 SSM 분석의 대상이 됩니다.

### **4.3 대체 안전 지표 (Surrogate Safety Measures, SSM) 산출 알고리즘**

Plan B의 핵심은 물리적 수식에 기반하여 위험도를 정량화하는 것입니다.

1\. 2D Time-to-Collision (TTC) 산출:  
일반적인 1차원 TTC(거리/상대속도)는 회전교차로와 같은 2차원 평면 운동에서 부정확합니다. 따라서 벡터 연산을 통한 2차원 TTC를 산출해야 합니다.10  
두 차량 $i, j$의 위치 벡터를 $\\mathbf{p}\_i, \\mathbf{p}\_j$, 속도 벡터를 $\\mathbf{v}\_i, \\mathbf{v}\_j$라 하고, 차량을 반경 $R$의 원으로 근사할 때, 충돌 조건은 두 중심 사이의 거리가 $2R$이 되는 시점 $t$를 찾는 것입니다.  
$$ |  
| (\\mathbf{p}\_i \+ \\mathbf{v}\_i t) \- (\\mathbf{p}\_j \+ \\mathbf{v}\_j t) ||^2 \= (2R)^2 $$  
이를 전개하면 $t$에 대한 2차 방정식 $At^2 \+ Bt \+ C \= 0$이 됩니다.

* $A \= |\\Delta \\mathbf{v}|^2$  
* $B \= 2 (\\Delta \\mathbf{p} \\cdot \\Delta \\mathbf{v})$  
* $C \= |\\Delta \\mathbf{p}|^2 \- (2R)^2$

여기서 $\\Delta \\mathbf{p} \= \\mathbf{p}\_i \- \\mathbf{p}\_j$, $\\Delta \\mathbf{v} \= \\mathbf{v}\_i \- \\mathbf{v}\_j$ 입니다. 근의 공식을 통해 구한 양의 실근 중 최솟값이 TTC가 됩니다. 만약 판별식이 음수이거나 양의 실근이 없다면 충돌 위험이 없는 상태(Diverging or Parallel)입니다.

2\. Post-Encroachment Time (PET) 산출:  
PET는 선행 차량이 충돌 영역(Conflict Area)을 벗어난 시점($t\_{exit, A}$)과 후행 차량이 해당 영역에 진입한 시점($t\_{entry, B}$)의 시간차입니다.20

$$PET \= | t\_{entry, B} \- t\_{exit, A} |$$

PET는 TTC와 달리 실제 충돌 궤적에 있지 않더라도(예: 간발의 차이로 지나감) 위험도를 측정할 수 있는 지표입니다. 통상적으로 PET \< 1.5초인 경우를 '임계적 갈등(Critical Conflict)' 또는 'Near-miss'로 분류합니다.9  
3\. Deceleration Rate to Avoid Collision (DRAC):  
충돌을 피하기 위해 필요한 최소 감속도를 의미합니다. 만약 이 값이 차량의 물리적 제동 한계(예: $8 m/s^2$)를 초과한다면, 사고가 불가피했던 상황으로 해석할 수 있습니다.

### **4.4 Plan B 실행 파이프라인 (Python Implementation Strategy)**

이 파이프라인은 GPU 학습 없이 CPU 기반으로 수행 가능하며, pandas, numpy, shapely 라이브러리를 사용합니다.

1. **데이터 로딩 및 필터링:** vehicle\_tracks\_xxx.csv를 로드하고, frame\_id를 기준으로 데이터를 정렬합니다. 연산 효율을 위해 회전교차로 영역(ROI) 밖의 데이터는 제외합니다.  
2. **공간 해싱 (Spatial Hashing):** 모든 차량 쌍(Pair)에 대해 충돌 검사를 수행하면 $O(N^2)$의 비용이 발생합니다. 이를 최적화하기 위해 격자(Grid) 기반의 공간 해싱이나 QuadTree를 사용하여 인접한 차량끼리만 연산을 수행하도록 합니다.  
3. **충돌/위험 탐지 루프:**  
   * 각 프레임에서 인접 차량 쌍에 대해 기하학적 교차(Intersection)를 검사합니다.  
   * 교차가 예상되는 경우, 2D TTC 방정식을 풉니다.  
   * $0 \< TTC \< Threshold$ (예: 4초)인 경우 이를 '위험 사건'으로 기록합니다.  
   * 충돌 지점을 통과하는 이벤트에 대해 PET를 계산하여 저장합니다.  
4. **결과 시각화 및 분석:**  
   * 검출된 위험 지점을 히트맵(Heatmap)으로 시각화하여 회전교차로 내의 '사고 다발 구역(Black Spot)'을 도출합니다. 이는 도로 설계 개선을 위한 중요한 엔지니어링 데이터를 제공합니다.

## ---

**5\. 비교 분석 및 통합 전략**

### **5.1 Plan A와 Plan B의 비교**

| 구분 | Plan A: Trajectron++ (GNN) | Plan B: 운동학적 분석 (SSM) |
| :---- | :---- | :---- |
| **핵심 기술** | Deep Generative Model (CVAE, Graph) | Computational Geometry, Kinematics |
| **입력 데이터** | 궤적 히스토리 \+ HD Map (Lanelet2) | 궤적 히스토리 (Map은 보조적) |
| **결과물** | 미래 궤적 생성 (Prediction) | 현재/미래 위험도 진단 (Diagnosis) |
| **장점** | 복잡한 의도 파악, 멀티모달 예측 가능 | 설명 가능성(Explainability), 물리적 정합성 100% |
| **단점** | 학습 난이도 높음, 해석의 어려움(Black-box) | 정형화된 물리 법칙에만 의존 (사회적 눈치 모름) |
| **데이터 로더** | trajdata (Native Support) | Custom Script (Pandas/Numpy) |

### **5.2 통합 연구 전략 (Hybrid Approach)**

본 연구의 가장 이상적인 방향은 Plan A와 Plan B를 경쟁시키는 것이 아니라 통합하는 것입니다.

1. **데이터 라벨링 강화:** Plan B의 알고리즘을 사용하여 INTERACTION Dataset의 모든 시나리오에 대해 TTC/PET 기반의 '위험도 라벨'을 자동으로 생성합니다. 이를 Trajectron++의 학습 데이터에 추가적인 속성으로 부여하여, 모델이 위험 상황을 명시적으로 인지하도록 학습시킬 수 있습니다.  
2. **Safety Layer 구축:** Trajectron++가 생성한 예측 궤적을 즉시 제어에 사용하는 대신, Plan B의 모듈을 통과시켜 물리적 충돌 가능성을 검사합니다. 만약 예측된 궤적의 TTC가 임계값보다 낮다면, 해당 예측을 기각하거나 안전한 궤적으로 보정하는 후처리(Post-processing) 로직을 적용할 수 있습니다.

## ---

**6\. 결론**

INTERACTION Dataset은 전 세계의 다양한 회전교차로 시나리오와 고정밀 지도 정보를 포함하고 있어, 씬 그래프 기반 상호작용 연구에 최적화된 데이터셋입니다. 연구의 실행 가능성을 극대화하기 위해, **Plan A**로는 지도 정보와 차량 동역학을 반영할 수 있고 trajdata를 통해 데이터 접근성이 확보된 **Trajectron++** 모델을 채택하는 것이 타당합니다. Social-STGCNN은 빠른 속도에도 불구하고 맵 제약 조건의 부재로 인해 회전교차로 환경에서는 제한적인 성능을 보일 것으로 예상됩니다.

동시에, 딥러닝 모델의 불확실성을 보완하기 위한 **Plan B**로서 2D TTC 및 PET 기반의 안전 지표 산출 시스템을 Python으로 구현해야 합니다. 이는 연구가 모델 학습 실패로 귀결되는 것을 방지하는 안전장치일 뿐만 아니라, 개발된 예측 모델의 성능을 객관적으로 검증하고 자율주행 시스템의 안전성을 보증하는 핵심 모듈로 기능할 것입니다. 본 보고서에서 제시한 로드맵에 따라 trajdata 기반의 파이프라인 구축과 shapely/numpy 기반의 안전 지표 분석을 병행한다면, 회전교차로 내 자율주행 상호작용 예측 기술의 완성도를 획기적으로 높일 수 있을 것입니다.

### ---

**첨부: Plan B 주요 지표 산출 로직 비교 (Python/Numpy)**

| 지표 | 수식적 정의 (개념) | Python 구현 핵심 라이브러리/함수 | 비고 |
| :---- | :---- | :---- | :---- |
| **Conflict Point** | $Shape\_A \\cap Shape\_B \\neq \\emptyset$ | shapely.geometry.LineString.intersection() | 궤적의 기하학적 교차점 계산 |
| **2D TTC** | $\\min\_{t\>0} |  | \\Delta \\mathbf{p} \+ \\Delta \\mathbf{v} t |
| **PET** | $ | t\_{entry, B} \- t\_{exit, A} | $ |
| **Spatial Hashing** | $Hash(x, y) \\rightarrow Cell\\\_ID$ | scipy.spatial.cKDTree 또는 Grid Indexing | $O(N^2)$ 연산을 $O(N)$으로 최적화 |

#### **참고 자료**

1. Interaction Dataset, 12월 14, 2025에 액세스, [http://interaction-dataset.com/](http://interaction-dataset.com/)  
2. (PDF) Interaction-Aware Intention Estimation at Roundabouts \- ResearchGate, 12월 14, 2025에 액세스, [https://www.researchgate.net/publication/354265718\_Interaction-Aware\_Intention\_Estimation\_at\_Roundabouts](https://www.researchgate.net/publication/354265718_Interaction-Aware_Intention_Estimation_at_Roundabouts)  
3. abduallahmohamed/Social-STGCNN: Code for "Social ... \- GitHub, 12월 14, 2025에 액세스, [https://github.com/abduallahmohamed/Social-STGCNN](https://github.com/abduallahmohamed/Social-STGCNN)  
4. Code accompanying "The Trajectron: Probabilistic Multi-Agent Trajectory Modeling with Dynamic Spatiotemporal Graphs" by Boris Ivanovic and Marco Pavone. \- GitHub, 12월 14, 2025에 액세스, [https://github.com/StanfordASL/Trajectron](https://github.com/StanfordASL/Trajectron)  
5. Details and Format \- Interaction Dataset, 12월 14, 2025에 액세스, [https://interaction-dataset.com/details-and-format](https://interaction-dataset.com/details-and-format)  
6. Interaction Dataset, 12월 14, 2025에 액세스, [https://interaction-dataset.com/](https://interaction-dataset.com/)  
7. NVlabs/trajdata: A unified interface to many trajectory ... \- GitHub, 12월 14, 2025에 액세스, [https://github.com/NVlabs/trajdata](https://github.com/NVlabs/trajdata)  
8. trajdata: A Unified Interface to Multiple Human Trajectory Datasets \- OpenReview, 12월 14, 2025에 액세스, [https://openreview.net/pdf?id=5ADv5OfQgU](https://openreview.net/pdf?id=5ADv5OfQgU)  
9. A Conflict-Based Safety Diagnosis of SCI Roundabouts Using a Surrogate Safety Measure Model \- MDPI, 12월 14, 2025에 액세스, [https://www.mdpi.com/2071-1050/15/17/13166](https://www.mdpi.com/2071-1050/15/17/13166)  
10. Location and time of impact for a moving point and a moving line segment (Continuous Collision Detection) \- Stack Overflow, 12월 14, 2025에 액세스, [https://stackoverflow.com/questions/63486253/location-and-time-of-impact-for-a-moving-point-and-a-moving-line-segment-contin](https://stackoverflow.com/questions/63486253/location-and-time-of-impact-for-a-moving-point-and-a-moving-line-segment-contin)  
11. An INTERnational, Adversarial and Cooperative moTION Dataset in Interactive Driving Scenarios with Semantic Maps \- arXiv, 12월 14, 2025에 액세스, [https://arxiv.org/abs/1910.03088](https://arxiv.org/abs/1910.03088)  
12. Trajectron++: Dynamically-Feasible Trajectory Forecasting With Heterogeneous Data \- European Computer Vision Association, 12월 14, 2025에 액세스, [https://www.ecva.net/papers/eccv\_2020/papers\_ECCV/papers/123630664.pdf](https://www.ecva.net/papers/eccv_2020/papers_ECCV/papers/123630664.pdf)  
13. Social-STGCNN: A Social Spatio-Temporal Graph Convolutional Neural Network for Human Trajectory Prediction \- CVPR 2020 Open Access Repository, 12월 14, 2025에 액세스, [https://openaccess.thecvf.com/content\_CVPR\_2020/html/Mohamed\_Social-STGCNN\_A\_Social\_Spatio-Temporal\_Graph\_Convolutional\_Neural\_Network\_for\_Human\_CVPR\_2020\_paper.html](https://openaccess.thecvf.com/content_CVPR_2020/html/Mohamed_Social-STGCNN_A_Social_Spatio-Temporal_Graph_Convolutional_Neural_Network_for_Human_CVPR_2020_paper.html)  
14. Back to the Future: Planning-Aware Trajectory Forecasting for Autonomous Driving, 12월 14, 2025에 액세스, [https://ai.stanford.edu/blog/trajectory-forecasting/](https://ai.stanford.edu/blog/trajectory-forecasting/)  
15. StanfordASL/Trajectron-plus-plus: Code accompanying the ... \- GitHub, 12월 14, 2025에 액세스, [https://github.com/StanfordASL/Trajectron-plus-plus](https://github.com/StanfordASL/Trajectron-plus-plus)  
16. shapely.intersection — Shapely 2.1.2 documentation \- Read the Docs, 12월 14, 2025에 액세스, [https://shapely.readthedocs.io/en/2.1.2/reference/shapely.intersection.html](https://shapely.readthedocs.io/en/2.1.2/reference/shapely.intersection.html)  
17. How to find the intersection between two geographic areas in python using shapely and cartopy ? \- Moonbooks, 12월 14, 2025에 액세스, [https://en.moonbooks.org/Articles/How-to-find-the-intersection-between-two-geographic-areas-in-python-using-shapely-and-cartopy-/](https://en.moonbooks.org/Articles/How-to-find-the-intersection-between-two-geographic-areas-in-python-using-shapely-and-cartopy-/)  
18. Second-Order Time to Collision With Non-Static Acceleration \- ResearchGate, 12월 14, 2025에 액세스, [https://www.researchgate.net/publication/388954971\_Second-Order\_Time\_to\_Collision\_With\_Non-Static\_Acceleration](https://www.researchgate.net/publication/388954971_Second-Order_Time_to_Collision_With_Non-Static_Acceleration)  
19. Extending Time to Collision for probabilistic reasoning in general traffic scenarios \- thelibraryofcivilengineer, 12월 14, 2025에 액세스, [https://thelibraryofcivilengineer.files.wordpress.com/2015/09/extending-time-to-collision-for-probabilistic-reasoning.pdf](https://thelibraryofcivilengineer.files.wordpress.com/2015/09/extending-time-to-collision-for-probabilistic-reasoning.pdf)  
20. Post Encroachment Time (PET) \- Criticality Metrics, 12월 14, 2025에 액세스, [https://criticality-metrics.readthedocs.io/en/latest/time-scale/PET.html](https://criticality-metrics.readthedocs.io/en/latest/time-scale/PET.html)  
21. Deep Learning Architectures for Skateboarder–Pedestrian Surrogate Safety Measures, 12월 14, 2025에 액세스, [https://www.mdpi.com/2673-7590/1/2/22](https://www.mdpi.com/2673-7590/1/2/22)